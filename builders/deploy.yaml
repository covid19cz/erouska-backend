steps:
- name: 'gcr.io/cloud-builders/gcloud'
  args:
  - functions
  - deploy
  - HelloHTTP
  - --source=.
  - --trigger-http
  - --region=europe-west1
  - --runtime=go113
  - --memory=128
  - --allow-unauthenticated

- name: 'gcr.io/cloud-builders/gcloud'
  args:
  - functions
  - deploy
  - ScoreReview
  - --source=.
  - --trigger-event=providers/cloud.firestore/eventTypes/document.create
  - --region=europe-west1
  - --runtime=go113
  - --memory=128
  - --allow-unauthenticated
  - --trigger-resource=projects/$PROJECT_ID/databases/(default)/documents/movie_reviews/{pushId}
